/* =========================================================
   Bulk.css (NUEVO) — Orden obligado:
   1) Toolbar arriba
   2) Tabla (grid) debajo
   3) Resultados debajo
   + Tabla full width con overflow scroll
   ========================================================= */

/* ---------- Scope base ---------- */
.ef-page.bulk-send{
  --bg: #f6f7fb;
  --card: #ffffff;
  --ink: #0f172a;
  --muted: #64748b;
  --line: #e6e8ef;
  --line2: #dfe3ee;
  --brand: var(--brand-600, #2563eb);
  --brand2: color-mix(in oklab, var(--brand) 75%, white);
  --radius: 22px;
  --shadow: 0 18px 45px rgba(2, 6, 23, .12);

  --pad: clamp(14px, 2vw, 20px);
  --gap: clamp(14px, 2vw, 18px);

  background: var(--bg);
  color: var(--ink);
  padding: clamp(14px, 2.4vw, 22px);
}

/* ---------- Toolbar arriba ---------- */
.bulk-send .bulk-toolbar{
  position: sticky;
  top: 0;
  z-index: 50;

  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 14px;

  padding: 14px var(--pad);
  margin-bottom: var(--gap);

  border: 1px solid var(--line);
  background: rgba(255,255,255,.88);
  backdrop-filter: blur(10px);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}

.bulk-send .bulk-toolbar__left{
  display: grid;
  gap: 6px;
}

.bulk-send .bulk-toolbar__title{
  font-weight: 900;
  letter-spacing: .25px;
  font-size: 16px;
  text-transform: uppercase;
}

.bulk-send .bulk-toolbar__meta{
  font-size: 12.5px;
  color: var(--muted);
  font-weight: 650;
}

.bulk-send .bulk-toolbar__right{
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: flex-end;
  align-items: center;
}

/* ---------- Botones (scoped) ---------- */
.bulk-send .btn{
  border: 1px solid var(--line);
  background: #fff;
  color: var(--ink);
  border-radius: 999px;
  padding: 9px 12px;
  font-size: 12px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 10px 20px rgba(2, 6, 23, .10);
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, opacity .12s ease;
}

.bulk-send .btn:hover{
  transform: translateY(-1px);
  border-color: var(--line2);
  box-shadow: 0 14px 26px rgba(2, 6, 23, .12);
}

.bulk-send .btn:active{ transform: translateY(0); }

.bulk-send .btn:disabled{
  opacity: .55;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.bulk-send .btn.btn-xs{ padding: 8px 12px; }

.bulk-send .btn.btn-primary-final{
  background: linear-gradient(180deg, var(--brand2), var(--brand));
  color: #fff;
  border-color: color-mix(in oklab, var(--brand) 60%, black);
}

.bulk-send .btn.btn-secondary{
  background: #fff;
}

/* =========================================================
   ✅ Orden: tabla debajo / resultados debajo
   Fuerza layout en columna aunque exista CSS viejo
   ========================================================= */
.bulk-send .bulk-main{
  display: grid !important;
  grid-template-columns: 1fr !important;
  grid-auto-flow: row;
  gap: var(--gap);
}

/* ---------- Cards ---------- */
.bulk-send .bulk-card,
.bulk-send .ef-card{
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

/* =========================================================
   ✅ TABLA (BulkGrid): full width + overflow scroll
   ========================================================= */
.bulk-send .bulk-grid-host{
  width: 100%;
  max-width: 100%;
  padding: 0;
}

/* El scroll horizontal/vertical lo maneja ESTE wrapper */
.bulk-send .bulk-grid__wrap{
  overflow: auto;
  max-width: 100%;
}

/* Scrollbars */
.bulk-send .bulk-grid__wrap{
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--muted) 45%, transparent) transparent;
}
.bulk-send .bulk-grid__wrap::-webkit-scrollbar{ height: 10px; width: 10px; }
.bulk-send .bulk-grid__wrap::-webkit-scrollbar-thumb{
  background: color-mix(in oklab, var(--muted) 45%, transparent);
  border-radius: 999px;
}
.bulk-send .bulk-grid__wrap::-webkit-scrollbar-track{ background: transparent; }

/* Header superior del grid (botón agregar + contador) */
.bulk-send .bulk-grid__topbar{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px var(--pad);
  border-bottom: 1px solid var(--line);
  background: #fff;
}

.bulk-send .bulk-grid__left{
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
}

.bulk-send .bulk-grid__meta{
  color: var(--muted);
  font-weight: 700;
  font-size: 12.5px;
}

/* Botones del grid */
.bulk-send .bulk-grid__btn{
  border: 1px solid var(--line);
  background: #fff;
  color: var(--ink);
  border-radius: 999px;
  padding: 9px 12px;
  font-size: 12px;
  font-weight: 900;
  cursor: pointer;
  box-shadow: 0 10px 20px rgba(2, 6, 23, .10);
  transition: transform .12s ease, border-color .12s ease, opacity .12s ease;
}

.bulk-send .bulk-grid__btn:hover{
  transform: translateY(-1px);
  border-color: var(--line2);
}

.bulk-send .bulk-grid__btn--danger{
  border-color: color-mix(in oklab, #ef4444 40%, var(--line));
  color: #b91c1c;
}

/* Tabla: que sea TAN ancha como necesite */
.bulk-send .bulk-grid__table{
  width: max-content;     /* crece según columnas */
  min-width: 100%;        /* pero mínimo ocupa todo el card */
  border-collapse: separate;
  border-spacing: 0;
  font-size: 13px;
}

/* header sticky */
.bulk-send .bulk-grid__th{
  position: sticky;
  top: 0;
  z-index: 5;

  background: #fff;
  border-bottom: 1px solid var(--line2);

  padding: 12px 12px;
  text-align: left;
  white-space: nowrap;
  font-weight: 950;
}

/* filas */
.bulk-send .bulk-grid__td{
  padding: 8px 10px;
  border-bottom: 1px solid var(--line);
  background: #fff;
  white-space: nowrap;
  vertical-align: middle;
}

.bulk-send .bulk-grid__tr:nth-child(2n) .bulk-grid__td{
  background: #fafbff;
}

/* inputs tipo excel */
.bulk-send .bulk-grid__cell{
  width: 100%;
  min-width: 220px;     /* evita aplastamiento */
  max-width: 380px;

  border: 1px solid var(--line2);
  border-radius: 10px;
  padding: 7px 9px;
  background: #fff;
  color: var(--ink);
  outline: none;

  transition: border-color .15s ease, box-shadow .15s ease;
}

.bulk-send .bulk-grid__cell:focus{
  border-color: color-mix(in oklab, var(--brand) 45%, var(--line2));
  box-shadow: 0 0 0 4px color-mix(in oklab, var(--brand) 18%, transparent);
}

.bulk-send .bulk-grid__cell:disabled{
  background: #f1f5f9;
  color: color-mix(in oklab, var(--ink) 65%, var(--muted));
}

/* acciones */
.bulk-send .bulk-grid__actions{
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

/* empty */
.bulk-send .bulk-grid__empty{
  padding: 18px var(--pad);
  color: var(--muted);
  font-weight: 700;
}

/* =========================================================
   Sticky columnas (ReferenceId y la 2da)
   Para que no se desalineen: widths fijos
   ========================================================= */
.bulk-send .bulk-grid__th.sticky-left,
.bulk-send .bulk-grid__td.sticky-left{
  position: sticky;
  left: 0;
  z-index: 7;
  background: #fff;
  box-shadow: 10px 0 18px rgba(2, 6, 23, .06);
  min-width: 260px;
}

.bulk-send .bulk-grid__th.sticky-left-2,
.bulk-send .bulk-grid__td.sticky-left-2{
  position: sticky;
  left: 260px; /* debe igualar min-width de la sticky-left */
  z-index: 7;
  background: #fff;
  box-shadow: 10px 0 18px rgba(2, 6, 23, .06);
  min-width: 260px;
}

/* Cuando hay zebra, mantenemos color en sticky cells */
.bulk-send .bulk-grid__tr:nth-child(2n) .bulk-grid__td.sticky-left,
.bulk-send .bulk-grid__tr:nth-child(2n) .bulk-grid__td.sticky-left-2{
  background: #fafbff;
}

/* =========================================================
   ✅ RESULTADOS: abajo de la tabla (otro card)
   ========================================================= */
.bulk-send .bulk-results{
  display: grid;
  grid-template-rows: auto 1fr;
  min-height: 260px;
}

.bulk-send .bulk-results__title{
  padding: 14px var(--pad);
  border-bottom: 1px solid var(--line);
  font-weight: 950;
  letter-spacing: .2px;
}

.bulk-send .bulk-results__empty{
  padding: var(--pad);
  color: var(--muted);
  font-weight: 700;
}

/* scroll si la tabla de resultados es ancha */
.bulk-send .bulk-results__wrap{
  overflow: auto;
  max-width: 100%;
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--muted) 45%, transparent) transparent;
}
.bulk-send .bulk-results__wrap::-webkit-scrollbar{ height: 10px; width: 10px; }
.bulk-send .bulk-results__wrap::-webkit-scrollbar-thumb{
  background: color-mix(in oklab, var(--muted) 45%, transparent);
  border-radius: 999px;
}
.bulk-send .bulk-results__wrap::-webkit-scrollbar-track{ background: transparent; }

.bulk-send .bulk-results__table{
  width: max-content;
  min-width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 12.5px;
}

.bulk-send .bulk-results__th,
.bulk-send .bulk-results__td{
  padding: 10px 12px;
  border-bottom: 1px solid var(--line);
  white-space: nowrap;
  vertical-align: top;
}

.bulk-send .bulk-results__th{
  position: sticky;
  top: 0;
  z-index: 3;
  background: #fff;
  font-weight: 950;
  border-bottom: 1px solid var(--line2);
}

.bulk-send .bulk-results__table tbody tr:nth-child(2n){
  background: #fafbff;
}

.bulk-send .bulk-results__table tbody tr:hover{
  background: #f2f6ff;
}

/* columna error legible */
.bulk-send .bulk-results__table th:last-child,
.bulk-send .bulk-results__table td:last-child{
  white-space: normal;
  min-width: 360px;
  max-width: 1000px;
  word-break: break-word;
}

/* Focus general */
.bulk-send :where(button, select, input, textarea, a):focus-visible{
  outline: none;
  box-shadow: 0 0 0 4px color-mix(in oklab, var(--brand) 18%, transparent);
  border-color: color-mix(in oklab, var(--brand) 40%, var(--line2));
}
