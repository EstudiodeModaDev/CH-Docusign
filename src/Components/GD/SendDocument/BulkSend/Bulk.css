/* =========================================================
   Bulk.css — cumple:
   1) Resultados debajo de la tabla (SIEMPRE)
   2) Tabla lo más ancha posible
   3) Si hay overflow -> scroll (horizontal y vertical donde aplique)
   Incluye estilos para BulkGrid (bulk-grid__*)
   ========================================================= */

/* ---------- Base / Scope ---------- */
.ef-page.bulk-send{
  --bg: var(--app-bg, #ffffff);
  --surface: var(--surface, #ffffff);
  --ink: var(--ink, #0f172a);
  --muted: var(--muted, #64748b);
  --border: var(--border, #e5e7eb);
  --brand: var(--brand-600, #2563eb);
  --ring: color-mix(in oklab, var(--brand) 35%, transparent);

  --radius: 22px;
  --radius-sm: 14px;
  --shadow: 0 18px 55px rgba(2, 6, 23, .16);
  --shadow2: 0 14px 40px rgba(2, 6, 23, .12);

  --pad: clamp(14px, 2.2vw, 20px);
  --gap: clamp(14px, 2.2vw, 18px);

  color: var(--ink);
  padding: clamp(14px, 2.5vw, 22px);
}

/* ---------- Cards ---------- */
.ef-page.bulk-send .bulk-card,
.ef-page.bulk-send .ef-card{
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--surface);
  box-shadow: var(--shadow2);
  overflow: hidden;
}

/* ---------- Panel inicial ---------- */
.ef-page.bulk-send .bulk-panel{
  max-width: 980px;
  margin: 0 auto;
}

.ef-page.bulk-send .bulk-panel__field{
  padding: var(--pad);
  display: grid;
  gap: 8px;
}

.ef-page.bulk-send .ef-label{
  font-size: 12.5px;
  color: var(--muted);
  font-weight: 650;
}

.ef-page.bulk-send .ef-input{
  width: 100%;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #fff;
  color: var(--ink);
  padding: 10px 12px;
  outline: none;
  transition: box-shadow .15s ease, border-color .15s ease;
}

.ef-page.bulk-send .ef-input:focus{
  border-color: color-mix(in oklab, var(--brand) 35%, var(--border));
  box-shadow: 0 0 0 4px var(--ring);
}

.ef-page.bulk-send .bulk-panel__actions{
  padding: 0 var(--pad) var(--pad);
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

/* ---------- Buttons (scoped) ---------- */
.ef-page.bulk-send .btn{
  border-radius: 999px;
  border: 1px solid var(--border);
  background: #fff;
  color: var(--ink);
  padding: 9px 12px;
  font-size: 12.5px;
  line-height: 1;
  font-weight: 700;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, opacity .12s ease;
  box-shadow: 0 10px 24px rgba(2, 6, 23, .10);
  user-select: none;
}

.ef-page.bulk-send .btn:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--border) 60%, black);
}

.ef-page.bulk-send .btn:active{ transform: translateY(0); }

.ef-page.bulk-send .btn:disabled{
  opacity: .55;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.ef-page.bulk-send .btn.btn-xs{
  padding: 8px 12px;
  font-size: 12px;
}

.ef-page.bulk-send .btn.btn-primary-final{
  background: linear-gradient(180deg,
    color-mix(in oklab, var(--brand) 85%, white) 0%,
    var(--brand) 70%,
    color-mix(in oklab, var(--brand) 80%, black) 100%
  );
  color: #fff;
  border-color: color-mix(in oklab, var(--brand) 55%, black);
  box-shadow: 0 14px 30px rgba(37, 99, 235, .22);
}

.ef-page.bulk-send .btn.btn-secondary{
  background: #fff;
}

/* ---------- Toolbar ---------- */
.ef-page.bulk-send .bulk-toolbar{
  position: sticky;
  top: 0;
  z-index: 50;

  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 14px;

  padding: 14px var(--pad);
  margin-bottom: var(--gap);

  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: rgba(255,255,255,.92);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow2);
}

.ef-page.bulk-send .bulk-toolbar__left{
  display: grid;
  gap: 6px;
  min-width: 220px;
}

.ef-page.bulk-send .bulk-toolbar__title{
  font-weight: 900;
  letter-spacing: .2px;
  font-size: 16px;
  text-transform: uppercase;
}

.ef-page.bulk-send .bulk-toolbar__meta{
  font-size: 12.5px;
  color: var(--muted);
  font-weight: 650;
}

.ef-page.bulk-send .bulk-toolbar__right{
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: flex-end;
}

/* =========================================================
   ✅ CONDICIÓN 1: RESULTADOS DEBAJO
   Fuerza 1 columna aunque haya CSS viejo/global
   ========================================================= */
.ef-page.bulk-send .bulk-main{
  display: grid !important;
  grid-template-columns: 1fr !important; /* SIEMPRE stack */
  gap: var(--gap) !important;
  align-items: start !important;
}

/* =========================================================
   ✅ CONDICIÓN 2 y 3: TABLA LO MÁS ANCHA + SCROLL
   El scroll debe vivir en el contenedor .bulk-grid-host
   ========================================================= */
.ef-page.bulk-send .bulk-grid-host{
  padding: 0;
  max-width: 100%;
  overflow: auto !important; /* horizontal/vertical según necesidad */
}

/* Scrollbar (opcional suave) */
.ef-page.bulk-send .bulk-grid-host{
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--muted) 55%, transparent) transparent;
}
.ef-page.bulk-send .bulk-grid-host::-webkit-scrollbar{ height: 10px; width: 10px; }
.ef-page.bulk-send .bulk-grid-host::-webkit-scrollbar-thumb{
  background: color-mix(in oklab, var(--muted) 55%, transparent);
  border-radius: 999px;
}
.ef-page.bulk-send .bulk-grid-host::-webkit-scrollbar-track{ background: transparent; }

/* =========================================================
   BulkGrid (grid editable tipo Excel)
   ========================================================= */
.ef-page.bulk-send .bulk-grid{
  min-width: 100%;
  padding: 0;
}

/* topbar del grid */
.ef-page.bulk-send .bulk-grid__topbar{
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;

  padding: 14px var(--pad);
  border-bottom: 1px solid var(--border);
  background: #fff;
}

.ef-page.bulk-send .bulk-grid__left{
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.ef-page.bulk-send .bulk-grid__meta{
  color: var(--muted);
  font-weight: 650;
}

/* botones del grid */
.ef-page.bulk-send .bulk-grid__btn{
  border-radius: 999px;
  border: 1px solid var(--border);
  background: #fff;
  color: var(--ink);
  padding: 9px 12px;
  font-weight: 800;
  font-size: 12.5px;
  cursor: pointer;
  box-shadow: 0 10px 24px rgba(2, 6, 23, .10);
  transition: transform .12s ease, border-color .12s ease, opacity .12s ease;
}

.ef-page.bulk-send .bulk-grid__btn:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--border) 60%, black);
}

.ef-page.bulk-send .bulk-grid__btn:active{ transform: translateY(0); }

.ef-page.bulk-send .bulk-grid__btn--danger{
  border-color: color-mix(in oklab, #ef4444 45%, var(--border));
  color: #b91c1c;
}

/* wrap interno del grid: no maneja el scroll (lo maneja bulk-grid-host) */
.ef-page.bulk-send .bulk-grid__wrap{
  padding: 0;
  min-width: 100%;
}

/* tabla: crecer lo que necesite para que aparezca scroll horizontal */
.ef-page.bulk-send .bulk-grid__table{
  width: max-content !important; /* clave: crece por columnas */
  min-width: 100% !important;    /* pero mínimo llena el card */
  border-collapse: separate;
  border-spacing: 0;
  font-size: 13px;
}

/* header */
.ef-page.bulk-send .bulk-grid__th{
  position: sticky;
  top: 0;
  z-index: 5;
  background: #fff;
  text-align: left;

  padding: 12px 12px;
  border-bottom: 1px solid var(--border);
  color: var(--ink);
  font-weight: 900;
  white-space: nowrap;
}

/* celdas */
.ef-page.bulk-send .bulk-grid__td{
  padding: 8px 10px;
  border-bottom: 1px solid var(--border);
  background: #fff;
  white-space: nowrap;
  vertical-align: middle;
}

/* zebra */
.ef-page.bulk-send .bulk-grid__tr:nth-child(2n) .bulk-grid__td{
  background: color-mix(in oklab, #fff 92%, #f1f5f9);
}

/* inputs de celda */
.ef-page.bulk-send .bulk-grid__cell{
  width: 100%;
  min-width: 220px;     /* para que se vea tipo excel y no se aplaste */
  max-width: 360px;

  border: 1px solid color-mix(in oklab, var(--border) 80%, black);
  border-radius: 8px;
  padding: 6px 8px;
  outline: none;

  background: #fff;
  color: var(--ink);

  transition: box-shadow .15s ease, border-color .15s ease;
}

.ef-page.bulk-send .bulk-grid__cell:focus{
  border-color: color-mix(in oklab, var(--brand) 40%, var(--border));
  box-shadow: 0 0 0 3px var(--ring);
}

.ef-page.bulk-send .bulk-grid__cell:disabled{
  background: color-mix(in oklab, #fff 85%, #e2e8f0);
  color: color-mix(in oklab, var(--ink) 70%, var(--muted));
}

/* acciones */
.ef-page.bulk-send .bulk-grid__actions{
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

/* empty row */
.ef-page.bulk-send .bulk-grid__empty{
  padding: 18px var(--pad);
  color: var(--muted);
  text-align: left;
}

/* ---------------------------------------------------------
   Sticky columns (ReferenceId + siguiente)
   OJO: necesitan left con widths consistentes.
   --------------------------------------------------------- */
.ef-page.bulk-send .bulk-grid__th.sticky-left,
.ef-page.bulk-send .bulk-grid__td.sticky-left{
  position: sticky;
  left: 0;
  z-index: 6;
  background: #fff;
  box-shadow: 10px 0 18px rgba(2, 6, 23, .06);
}

.ef-page.bulk-send .bulk-grid__th.sticky-left-2,
.ef-page.bulk-send .bulk-grid__td.sticky-left-2{
  position: sticky;
  left: 280px; /* ≈ min-width de la 1ra columna (220) + paddings/bordes */
  z-index: 6;
  background: #fff;
  box-shadow: 10px 0 18px rgba(2, 6, 23, .06);
}

/* Ajuste para que la 1ra columna tenga ancho estable */
.ef-page.bulk-send .bulk-grid__td.sticky-left .bulk-grid__cell,
.ef-page.bulk-send .bulk-grid__th.sticky-left{
  min-width: 260px;
}
.ef-page.bulk-send .bulk-grid__td.sticky-left-2 .bulk-grid__cell,
.ef-page.bulk-send .bulk-grid__th.sticky-left-2{
  min-width: 260px;
}

/* =========================================================
   Resultados (debajo) + scroll si es ancho
   ========================================================= */
.ef-page.bulk-send .bulk-results{
  display: grid;
  grid-template-rows: auto 1fr;
  min-height: 260px;
}

.ef-page.bulk-send .bulk-results__title{
  padding: 14px var(--pad);
  border-bottom: 1px solid var(--border);
  font-size: 14px;
  font-weight: 900;
  background: #fff;
}

.ef-page.bulk-send .bulk-results__empty{
  padding: var(--pad);
  color: var(--muted);
  font-weight: 650;
}

.ef-page.bulk-send .bulk-results__wrap{
  overflow: auto;
  max-width: 100%;
}

/* tabla resultados: max-content para que si crece, haga scroll */
.ef-page.bulk-send .bulk-results__table{
  width: max-content;
  min-width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 12.5px;
}

.ef-page.bulk-send .bulk-results__th,
.ef-page.bulk-send .bulk-results__td{
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  vertical-align: top;
  white-space: nowrap;
}

.ef-page.bulk-send .bulk-results__th{
  position: sticky;
  top: 0;
  z-index: 2;
  background: #fff;
  font-weight: 900;
}

/* Error column legible */
.ef-page.bulk-send .bulk-results__table th:last-child,
.ef-page.bulk-send .bulk-results__table td:last-child{
  white-space: normal;
  min-width: 360px;
  max-width: 900px;
  word-break: break-word;
}

/* Focus visible */
.ef-page.bulk-send :where(button, select, input, textarea, a):focus-visible{
  outline: none;
  box-shadow: 0 0 0 4px var(--ring);
  border-color: color-mix(in oklab, var(--brand) 35%, var(--border));
}
